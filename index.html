<!DOCTYPE html>
<script src="phonegap.js"></script>
<html>
<head>
    <title>Smart Mobility</title>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

    <script type="text/javascript" src="js/watchPosition.js"></script>
    <script type="text/javascript" src="js/display.js"></script>

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="js/jquery.mobile-1.3.0.min.js"></script>

    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyAFRibImU7l2cmjIPF4S0yJ8r7YkxLeOHA&sensor=true"></script>

    <link rel="stylesheet" href="css/index.css" />

    <script type="text/javascript">
        var map;

        var myIcon = L.icon({
            iconUrl: 'image/position-marker.png',
            iconRetinaUrl: 'image/position-marker.png',
            iconSize: [15, 15]
        });

        var userMarker = new L.marker([0,0], {icon : myIcon});

        function successCallback(position){
            console.log("Latitude : " + position.coords.latitude + ", longitude : " + position.coords.longitude);
            userMarker.setLatLng(new L.LatLng(position.coords.latitude, position.coords.longitude));
        }

        function centerMap() {
            map.setView(userMarker.getLatLng(), 15);
        }

        var watchID = navigator.geolocation.watchPosition(successCallback, errorCallback, {frequency:1000, enableHighAccuracy:true});

        function initialize() {

            map = new L.Map('map_canvas');

            // create the tile layer with correct attribution
            var mapquestUrl = 'http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png';
            var subDomains = ['otile1','otile2','otile3','otile4'];
            var mapquestAttrib = '';
            var mapquest = new L.TileLayer(mapquestUrl, {maxZoom: 18, attribution: mapquestAttrib, subdomains: subDomains});

            map.setView(new L.LatLng(47.3, 2.47),8);

            userMarker.addTo(map);

            map.addLayer(mapquest);
        }

        $('#carte').live('pageshow',function(event, ui){
            initialize();
            submitform();
        });

        function togglePOI2() {
            $("#poi2").toggle("fast", "linear", function (data) {});
        }

        function addAdr2(balise) {
            if (balise=="Maison"){
                $("#adr2").val("26, rue pierre louvrier, clamart");
            }
            else if (balise=="Travail"){
                $("#adr2").val("2, avenue sully prud'homme, sceaux");
            }
        }

    </script>

</head>
<body>

<div data-role="page" data-theme="b" id="accueil">

    <select name="car_check" id="car_check" data-role="slider" data-track-theme="a" data-theme="a">
        <option value="off">Car</option>
        <option value="on">Foot</option>
    </select>

    <img id="noomad" src="image/noomad.png"/>

    <div data-role="fieldcontain" style="margin-left: 10px;">
        <div class="ui-grid-a">
            <div class="ui-block-a">
                <input type="search" style="width:300px;" name="adr2" id="adr2" value="" data-theme="a" placeholder="OÃ¹ souhaitez-vous aller ?"/>
            </div>
            <div class="ui-block-b">
                <a href="map.html" data-role="button" data-icon="arrow-r" data-iconpos="right" data-theme="c" data-transition="flip">Go</a>
            </div>
        </div>
    </div>

    <div data-role="footer" class="ui-grid-c" data-position="fixed" style="height:60px; text-align: center;">
            <div class="ui-block-a" >
                <a href="#positionWindow" data-rel="popup" data-icon="star" data-role="button" style="height:30px;">Favoris</a>
            </div>
            <div class="ui-block-b">
                <a href="" data-role="button" data-icon="home" style="height:30px;">Facebook</a>
            </div>
            <div class="ui-block-c">
                <a href="" data-role="button" data-icon="search" style="height:30px;">Recent</a>
            </div>
            <div class="ui-block-d">
                <a href="" data-role="button" data-icon="search" style="height:30px;">POI</a>
            </div>
    </div>

    <div data-role="popup" class="ui-content" id="positionWindow">
        <a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-left">Close</a>
        <ul data-role="listview" data-theme="d">
            <li><a data-rel="back" onclick="addAdr2(this.text)">Maison</a></li>
            <li><a data-rel="back" onclick="addAdr2(this.text)">Travail</a></li>
            <li><a data-rel="back" onclick="addAdr2(this.text)">ECP</a></li>
        </ul>
    </div>

    <div id="poi2" data-role="fieldcontain" style="background-color: #FF8400; display: none">
        <input type="button" data-inline="true" value="Home" data-theme="c" onclick="addAdr2(this.value)"/>
        <input type="button" data-inline="true" value="Work" data-theme="c" onclick="addAdr2(this.value)"/>
    </div>
</div>
</body>
</html>

